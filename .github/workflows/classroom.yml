name: Prueba de Autograding

on: [push, workflow_dispatch]

permissions:
  checks: write   # CRUCIAL: Necesario para escribir la nota
  actions: read
  contents: read

jobs:
  probar-nota:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # 1. Simulamos tu script de tests
      - name: Simular Script de Tests
        id: calculo
        run: |
          # Generamos una nota aleatoria entre 50 y 100
          NOTA_RANDOM=$(( ( RANDOM % 51 ) + 50 ))
          echo "Simulando ejecución de tests..."
          echo "Nota calculada: $NOTA_RANDOM"
          
          # Guardamos la nota en el output para el siguiente paso
          echo "puntos=$NOTA_RANDOM" >> $GITHUB_OUTPUT

      # 2. Ejecutamos la acción de Mark Patterson
      - name: Reportar Nota a GitHub
        uses: markpatterson27/autograding@dev-points-input-release
        with:
          points: ${{ steps.calculo.outputs.puntos }}
          available-points: 100
